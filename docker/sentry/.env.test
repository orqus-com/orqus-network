# =============================================================================
# Orqus Sentry Node - Test Network Configuration
# =============================================================================
# 用途: 公开 RPC 节点，连接到 K8s 测试网集群
# 更新时间: 2026-01-27
# =============================================================================

# 网络选择
NETWORK=test

# =============================================================================
# P2P Bootnode 配置 (从 K8s 集群获取)
# =============================================================================
# Reth bootnode (enode://pubkey@host:port)
# 端口: 31281 (K8s NodePort for Reth P2P)
RETH_BOOTNODES=enode://8318535b54105d4a7aae60c08fc45f9687181b4fdfc625bd1a753fa7397fed753547f11ca8696646f2f3acb08e31016afac23e630c5d11f59f61fef57b0d2aa5@47.243.179.141:31281

# CometBFT persistent peers (node_id@host:port)
# 端口: 31259 (K8s NodePort for CometBFT P2P)
COMETBFT_PERSISTENT_PEERS=1206dae3ff4886b12a8e7f76b49ff487206bbf56@47.243.179.141:31259

# =============================================================================
# RPC 配置
# =============================================================================
# 绑定地址 (0.0.0.0 = 公开, 127.0.0.1 = 仅本地)
RPC_HOST=0.0.0.0
RPC_PORT=8545
WS_PORT=8546

# 本机公网 IP (用于 NAT 穿透，可选)
EXTERNAL_IP=

# =============================================================================
# Docker 镜像
# =============================================================================
RETH_IMAGE=registry.orqes.com/orqus-reth:test-84
ORQUSBFT_IMAGE=registry.orqes.com/orqusbft:test-84
COMETBFT_IMAGE=cometbft/cometbft:v0.38.15

# =============================================================================
# 数据目录
# =============================================================================
DATA_DIR=./data

# =============================================================================
# 故障排查命令
# =============================================================================
# 检查 Reth P2P 连接:
#   docker logs orqus-reth-sentry 2>&1 | grep -i peer
#
# 检查 CometBFT P2P 连接:
#   docker logs cometbft-sentry 2>&1 | grep -i peer
#
# 测试 bootnode 端口连通性:
#   nc -zv 47.243.179.141 31281
#   nc -zv 47.243.179.141 31259
#
# 重置数据并重新同步:
#   docker-compose --env-file .env.test down
#   rm -rf ./data/*
#   docker-compose --env-file .env.test up -d
